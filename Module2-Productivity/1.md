# Module 2: Productivity

# Exercise 6: Extending Productivity using Teams and Outlook

## Scenario

Contoso wants to integrate the SAP system and Microsoft Azure to view the Sales Order data in a Teams channel or through an e-mail in Outlook. 

To achieve these requirements, you will be configuring a Logic App to display the SAP ERP data in Teams and send an email of the latest sales order data to Outlook at regular intervals.

## Overview

In this exercise, you will review the existing Logic App and configure a Logic App to display the SAP ERP data in Teams and send an email of the SAP data to Outlook. Then, you will run the Logic App and review the data triggered by it in Teams and Outlook.

This exercise includes the following tasks:

* Configure the Logic App to display SAP ERP data in Teams and send an email to Outlook.
* Run the Logic App and review the Logic App run. 
* Review the messages in Microsoft Teams.
* Review the generated e-mail in Outlook.

## Task 1: Configure the Logic App to display SAP ERP data in Teams

In this task, you will configure a Logic App to display the SAP ERP data in Teams and send an email of the SAP data to Outlook.

 You can perform the Task 1.1 in which you will configure the Logic App and integrate it with SAP data and Teams. After that, you can continue to Task 2. Please note that you don't have to perform Task 1.2 if you are able to successfully complete Task 1.1.

> ```Note```: If you get any issue while configuring the logic app flow, you can check the pre-configured Logic App **sap-teams-demo**-<inject key="DeploymentID" /> which has been provisioned for you. To use that logic app, please perform Task 1.2 to renew the authorization to Teams and Office365 and trigger the Logic App flow and continue onto Task 

### Task 1.1: Integrate the Logic App with SAP and Teams by configuring it.

1. Navigate back to the aiw-sap-iothub-<inject key="DeploymentID" /> resource group and select la-sap-teams-<inject key="DeploymentID" />.

1. When you select the Logic App, the Logic Apps Designer opens. Scroll down to **Templates** and select **Blank Logic App**.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-Ex4-logicapp-2.png?raw=true)

1. Select the **All** tab to add the **recurrence** action.

1. In the Logic Apps Designer search box, enter **recurrence (1)** and select the trigger named **Recurrence (2)**.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-1.png?raw=true)
   
   > Info: Using **Recurrence** trigger, you can run your workflow at regular time intervals based on the specified schedule. Here, you will schedule the trigger for 1 hour so that every 1 hour the workflow will be triggered and SAP ERP data is displayed in Teams, and an email with the most recent sales order data is sent to Outlook.
   
1. Inside the trigger, change these properties as described below to trigger the action every 5 minutes.

     1. Interval	: Enter **1**
     1. Frequency : Select **Hour** from the dropdown.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-2.png?raw=true)

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Select **HTTP** from the list.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-40.png?raw=true)

1. Under **Actions**, select **HTTP** again.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-Ex4-logicapp-10.png?raw=true)
   
1. Select **ellipsis (...)** icon to view more actions.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-Ex4-logicapp-11.png?raw=true)
   
1. Select **Rename** to rename the HTTP action.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-Ex4-logicapp-11.1.png?raw=true)

1. Replace the existing name **HTTP** with the below name and select anywhere in the Logic App designer to save the name.

   ```
   http_get_request
   ```
   
   > Info: In the following steps, you will configure the **http_get_request** action to login to the SAP Gateway system and get the top 50 SalesOrders from the sales order dataset.
  
1. Under **Method**, select **GET** from the dropdown.

1. Now, enter the below value in the URI field.
   ```
   https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC/SalesOrderSet/
   ```
      
1. To add the **Accept : application/json;odata=verbose**  Header, perform the below steps
         
      1. Enter the below value under **Key** field.
         ```
         Accept
         ```
      2. Enter the below value under **Value** field.
         ```
         application/json;odata=verbose
         ```

1. Now, scroll down and select **Add Parameter** then **Authentication** from the dropdown.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-3.png?raw=true)

1. Under Authentication, enter the following information:

     - **Authentication type** : Select **Basic** from the dropdown.
     - **Username** : Enter the username of Es5 demo account which you noted earlier.
     - **Password** : Enter the password of the ES5 demo account: <inject key="AzureAdUserPassword"></inject>  

    ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-Ex4-logicapp-14.png?raw=true)

1. After adding all the values, the final screenshot will look like this:

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-4.png?raw=true)
      
1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **Data operations** and select it.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-5.png?raw=true)

1. Under **Actions**, select **Parse JSON** to create user-friendly data tokens for properties in JSON content and to use the properties easily in the Logic Apps.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-6.png?raw=true)

1. Enter the following information in the **Parse JSON** action: 

   - Content:  To Add the **Body** output of the HTTP request, follow the below steps

       1. Click inside the edit box of **Content** so that the dynamic content list appears.  
       2. Select **Body** which is under **http_get_request** from the dynamic content list.

          ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-7.png?raw=true)

   - Now,  select **Use sample payload to generate schema** to add sales order data.

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-8.png?raw=true)
   
   - You will be presented with the below page to enter a sample JSON payload.

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-9.png?raw=true)
   
   - Enter the following content and click on **Done**.

     ```
     {
     "d": {
      "results": [
      {
        "__metadata": {
          "id": "https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC/SalesOrderSet('0500000000')",
          "uri": "https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC/SalesOrderSet('0500000000')",
          "type": "GWSAMPLE_BASIC.SalesOrder"
        },
        "SalesOrderID": "0500000000",
        "Note": "EPM DG: SO ID 0500000000 Deliver as fast as possible",
        "NoteLanguage": "EN",
        "CustomerID": "0100000000",
        "CustomerName": "SAP",
        "CurrencyCode": "USD",
        "GrossAmount": "14385.85",
        "NetAmount": "12088.95",
        "TaxAmount": "2296.90",
        "LifecycleStatus": "C",
        "LifecycleStatusDescription": "Closed",
        "BillingStatus": "P",
        "BillingStatusDescription": "Paid",
        "DeliveryStatus": "D",
        "DeliveryStatusDescription": "Delivered",
        "CreatedAt": "\/Date(1538344800000)\/",
        "ChangedAt": "\/Date(1538949600000)\/",
        "ToBusinessPartner": {
          "__deferred": {
            "uri": "https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC/SalesOrderSet('0500000000')/ToBusinessPartner"
          }
        },
        "ToLineItems": {
          "__deferred": {
            "uri": "https://sapes5.sapdevcenter.com/sap/opu/odata/iwbep/GWSAMPLE_BASIC/SalesOrderSet('0500000000')/ToLineItems"
               }
              }
             }
            ]
           }
          }
        ```  

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-10.png?raw=true)

   - After adding all the values, the final screenshot will look like this:

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-11.png?raw=true)

1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **variables** and select it from the list.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-12.png?raw=true)

1. Under **Actions**, select **Initialize variable** to initialize a variable.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-13.png?raw=true)

1. Enter the following information to initialize a variable, so that each row or sales order of the parsed JSON resultset will be stored in it.

   - Name: Enter the below value.
     ```
     ArraySalesOrder
     ```
   - Type: Select **Array** from the dropdown.
   - After adding all the values, the final screenshot will look like this:

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-14.png?raw=true)

1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.
   
1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **Control** and select it from the list.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-15.png?raw=true)

1. Under **Actions**, select **For each** to create for each control.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-16.png?raw=true)

1. To add **For each** control, enter the following information:

   1. Select an output from previous steps: You will be providing the variable **results** from Parse JSON as input for each statement. Perform the below steps to do it:

       1. Click inside the edit box of **Select an output from the previous step** so that the dynamic content list appears on the right of the designer.  
       2. Select **results** which is under **Parse JSON** from the dynamic content list.

          ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-17.png?raw=true)
  
   1. Now, select **Add an action** to add a new action.

      ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-18.png?raw=true)

   1. Now, under **Choose an Operation**, select the **All** tab.
   1. Search for **Data operations** and select it.

      ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-5.png?raw=true)

1. Under **Actions**, select **Compose** to create a message from the input that can include various data types.

      ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-19.png?raw=true)

   1. Enter the following information to the inputs section of compose action
      ```
      {
        "BillingStatus": "@{items('For_each')?['BillingStatus']}",
        "BillingStatusDescription": "@{items('For_each')?['BillingStatusDescription']} ",
        "ChangedAt": "@{items('For_each')?['ChangedAt']}",
        "CreatedAt": "@{items('For_each')?['CreatedAt']}",
        "CurrencyCode": "@{items('For_each')?['CurrencyCode']}",
        "CustomerID": "@{items('For_each')?['CustomerID']}",
        "CustomerName": "@{items('For_each')?['CustomerName']}",
        "DeliveryStatus": "@{items('For_each')?['DeliveryStatus']}",
        "DeliveryStatusDescription": "@{items('For_each')?['DeliveryStatusDescription']}",
        "GrossAmount": "@{items('For_each')?['GrossAmount']}",
        "LifecycleStatus": "@{items('For_each')?['LifecycleStatus']}",
        "LifecycleStatusDescription": "@{items('For_each')?['LifecycleStatusDescription']}",
        "NetAmount": "@{items('For_each')?['NetAmount']}",
        "Note": "",
        "NoteLanguage": "@{items('For_each')?['NoteLanguage']}",
        "SalesOrderID": "@{items('For_each')?['SalesOrderID']}",
        "TaxAmount": "@{items('For_each')?['TaxAmount']}"
       }
       ```
       After adding the content, the final screenshot will look like this:
       
       ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-20.png?raw=true)
       
   1. Now, select **Add an action** to add a new action.
   1. Now, under **Choose an Operation**, select the **All** tab.
   1. Search for **variables** and select it from the list.

      ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-12.png?raw=true)

   1. Under **Actions**, select **Append to array variable** action to add each record to the variable ArraySalesOrder within the “For each” action.

      ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-21.png?raw=true)

   1. Enter the following information to create append to array variable action:
      - Name: Select **ArraySalesOrder** from the dropdown.
      - Value: To add the Outputs of Compose as value, follow the below steps:
      
         1. Click inside the edit box of **Value** so that the dynamic content list appears.  
         2. Select **results** which is under **Compose** from the dynamic content list.

            ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-22.png?raw=true)

         3. After adding all the actions for each control, the final screenshot will look like this:

            ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-23.png?raw=true)


1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **Data operations** and select it.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-5.png?raw=true)

1. Now, select **Create HTML table** under **actions** to	create a HTML table from the **ArraySalesOrder** array.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-24.png?raw=true)

1. Enter the following information to create a formatted message out of the **ArraySalesOrders** variable.

   1. From : To provide **ArraySalesOrders** variable as input follow the below steps:
   
       1. Click inside the edit box of **Select an output from previous step** so that the dynamic content list appears.  
       2. Select **ArraySalesOrders** which is under **Variables** from the dynamic content list.

        ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-25.png?raw=true)

   2. Columns: Automatic
   3. After adding all the values, the final screenshot will look like this:

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-26.png?raw=true)


1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **Microsoft teams** and select it.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-27.png?raw=true)

1. Under **Actions**, scroll down and select **Post a message V(3) (Preview)** action to post a message to Teams.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-28.png?raw=true)

1. Click on **Sign in** and use the below credentials to sign in to the team's account.

   * Email/Username: <inject key="AzureAdUserEmail"></inject>
   * Password: <inject key="AzureAdUserPassword"></inject>

1. Under **Post a message V(3) (Preview)** action, enter the following information:

   1. Team: Select **SAP on Azure-<inject key="DeploymentID" />** from the dropdown
   2. Channel: Select **SAP Channel** from the dropdown
   3. Message: Enter `SAP with Azure!` and click enter. 
      - Now we need to add the **Output** of Create HTML Table into the Message box so that data will be posted in the teams along with the message. To do so, perform the below steps:
         1. Click inside the edit box of **Message** so that the dynamic content list appears.
         2. In the **Dynamic Content** list, select **See more** which is next to Create HTML Table.
         3. Select **results** which is under **Create HTML Table** from dynamic content list.

          ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-29.png?raw=true)

   1. After adding all the values, the final screenshot will look like this:

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-30.png?raw=true)


1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

1. Select **New step** to add a new step. 

1. Now, under **Choose an Operation**, select the **All** tab.

1. Search for **Office 365 Outlook** and select it.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-31.png?raw=true)

1. Under **actions**, scroll down and select **Send an email (V2)** to send the SAP sales order data via email.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-32.png?raw=true)


1. Under the **Send an email (V2)** step, enter the following information
 
   1. To: Enter <inject key="AzureAdUserEmail"></inject>
   2. Subject: Enter **SAP with Azure!**
   3. Body: Enter `Send a mail form SAP!` and click enter.
     - Now we need to add the **Output** of Create HTML Table into the Message box so that data will be posted in the teams along with the message. To do so, perform the below steps:
         1. Click inside the edit box of **Message** so that the dynamic content list appears.
         2. In the **Dynamic Content** list, select **See more** which is next to Create HTML Table.
         3. Select **results** which is under **Create HTML Table** from dynamic content list.

          ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-29.png?raw=true)

   4. After adding all the values, the final screenshot will look like this:

     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-33.png?raw=true)

1. Select **Save** on the menu at the top of the Logic Apps Designer to save your changes.

### Task 1.2: Pre-configured Logic App Flow for reference

In this task you will renew the authorization to Teams and Office365 to use the pre-configured Logic App and trigger the Logic App flow.

1. Navigate back to the **aiw-sap-iothub-<inject key="DeploymentID" />** resource group and select the Logic App named **sap-teams-demo-<inject key="DeploymentID" />**.

1. Select **Overview** from the left-hand side menu of the Logic App. 

1. On the **Overview** pane toolbar, click on **Enable** to enable the Logic App and trigger it manually.

1. Select **Logic app designer** from the left-hand side menu and review all the triggers and actions in the flow.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-1.png?raw=true)

1. Now, expand the **Teams** Connection and notice that it shows an invalid connection. 

   > Info: This is because the session to the Teams connection is expired, you will have to re-establish the session to the connection.
   
   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-4.png?raw=true)

1. To establish the connection, navigate back to the aiw-sap-iothub- resource group and select the API Connection named **teams**.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-5.png?raw=true)

1. Select **Edit API connection** from the left-hand side menu to edit the connection.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-6.png?raw=true)

1. On the **Edit API connection** blade, click on **Authorize** to renew the authorization and establish the session.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-7.png?raw=true)

1. You will be prompted to enter the credentials, use the below credentials to complete the Sign-in process.

   * Email/Username: <inject key="AzureAdUserEmail"></inject>
   * Password: <inject key="AzureAdUserPassword"></inject>

1. Once authorization is complete, click on **Save** to save the changes.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-8.png?raw=true)

1. Navigate back to the **sap-teams-demo-<inject key="DeploymentID" />** Logic App, select **Logic app designer** from the left-hand side menu, and review the **Post a message V(3) (Preview)** action.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-9.png?raw=true)

1. Now,  expand the **Outlook** Connection and notice that it shows an invalid connection. 
   
   > Info: This is due to the session to Office365 Connection is expired, you will have to re-establish the session to the connection.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-10.png?raw=true)

1. To establish the connection, navigate back to the aiw-sap-iothub- resource group and select the API Connection named **Office365**.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-11.png?raw=true)

1. Repeat steps 5-8 to renew the authorization and establish the session.

1. Navigate back to the **sap-teams-demo-<inject key="DeploymentID" />** Logic App, select **Logic app designer** from the left-hand side menu, and review the **Send an email (V2)** action.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-13.png?raw=true)

1. Next, expand the **HTTP** action and notice that Username and Password values are to be replaced with your credentials to connect to the SAP system.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-2.png?raw=true)

1. Replace the **YOURUSERNAME** and **YOURPWD** with the following values.

     1. **Username**: Enter the username of the Es5 demo account which you noted earlier.
     2. **Password**: Enter the password of the ES5 demo account: <inject key="AzureAdUserPassword"></inject>  

1. After adding all the values, the final screenshot will look like this:

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-3.png?raw=true)

1. Select Save on the menu at the top of the Logic Apps Designer to save your changes.

1. After configuring the required actions, your flow will look like the below screenshot.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2%20-Ex6-demologicapp-12.png?raw=true)

## Task 2: Run the Logic App and review the Logic App run. 

In this task, you will run the Logic App by triggering it manually and review the Logic App run.

1. Navigate back to the aiw-sap-iothub-<inject key="DeploymentID" /> resource group and select la-sap-teams-<inject key="DeploymentID" />. 

1. Select **Logic app designer (1)** from the left-hand side menu and click on **Run (2)**.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-34.png?raw=true)

1. Once you click on **Run**, the Logic App will be triggered and will start its run.

1. Now, select **overview** from the left-hand side menu then scroll down and select **Run history** tab.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-35.png?raw=true)

1. Select the most recent run and review the Logic App run details then, minimize the Azure Portal window.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-36.png?raw=true)
   
   > **Note**: If you are not able to see the Logic App run under **Run history**, click on **Refresh** to fetch the recent results.

## Task 3: Review the messages in Microsoft Teams

In this task, you will review the SAP ERP data that is being sent to Microsoft Teams by the Logic App at regular intervals.

1. Launch the **Microsoft Teams** application by clicking on the Microsoft Teams shortcut on the virtual machine desktop.

1. You can use the below credentials to sign in to the team's account.

   * Email/Username: <inject key="AzureAdUserEmail"></inject>
   * Password: <inject key="AzureAdUserPassword"></inject>

1. Select **Teams** from the left-hand side menu to view the available teams.

1. Review the messages which are being sent as a part of the Logic App run into the **SAP on Azure-<inject key="DeploymentID" />** teams channel.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-37.png?raw=true)

1. Note the interval between the messages, it is 1 hour as we added 1 hour as the trigger interval in the recurrence trigger.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-38.png?raw=true)


## Task 4: Review the Logic App Run generated e-mail in Outlook

In this task, you will review the SAP ERP data that is being sent to you by the Logic App via mail.

1. Return to the browser tab in which outlook was open. If you have closed the tab, navigate to this URL `https://outlook.live.com/owa/` and click on **sign in** to sign in to your account.

1. You can use the below credentials to sign in to your account.

   * Email/Username: <inject key="AzureAdUserEmail"></inject>
   * Password: <inject key="AzureAdUserPassword"></inject>

1. Now, open the mail that is being triggered by the Logic App and review the sales data.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-39.png?raw=true)
      
1. Navigate back to the browser tab in which Azure Portal is open and select the Logic App named la-sap-teams-<inject key="DeploymentID" /> .

1. Select **Overview** from the left-hand side menu of the Logic App. 

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-42.png?raw=true)

1. On the **Overview** pane toolbar, click on **Disable** to disable the Logic App.

   ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/blob/main/media/M2-p2-logicapp-41.png?raw=true)

## Summary

In this exercise, you have covered the following:

* Reviewed the existing Logic App and configured it to display SAP ERP data in Teams and send an email to Outlook.
 * Reviewed the Logic App run.
 * Reviewed the messages in the teams channel which are being sent as a part of the Logic App run.
 * Reviewed the generated e-mail in Outlook.
